@using DAO_WebPortal.Resources
@{
    Layout = "../Shared/_MainLayout.cshtml";

}

<script src="../Home/lib/ckeditor/ckeditor.js"></script>

<div id="typeSelectionDiv">
    <h4 class="mt-5">Select a vote type</h4>
    <div class="row">
        <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="card voteTypeCard" onclick="SelectVoteType('simple')">
                <div class="card-body">
                    <h4>Simple</h4>
                    <i class="fas fa-vote-yea"></i>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="card voteTypeCard" onclick="SelectVoteType('vaonboarding')">
                <div class="card-body">
                    <h4>VA Onboarding</h4>
                    <i class="fas fa-user-plus"></i>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="card voteTypeCard" onclick="SelectVoteType('repo')">
                <div class="card-body">
                    <h4>Governance</h4>
                    <i class="fas fa-university"></i>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="card voteTypeCard" onclick="SelectVoteType('kyc')">
                <div class="card-body">
                    <h4>KYC</h4>
                    <i class="fas fa-user-check"></i>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="card voteTypeCard" onclick="SelectVoteType('reputation')">
                <div class="card-body">
                    <h4>Reputation</h4>
                    <i class="fas fa-star"></i>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 col-sm-6">
            <div class="card voteTypeCard" onclick="SelectVoteType('slashing')">
                <div class="card-body">
                    <h4>Slashing</h4>
                    <i class="fas fa-user-slash"></i>
                </div>
            </div>
        </div>
    </div>

</div>

<div class="row d-none mt-3" id="voteInputsDiv">
    <div class="col-md-12">

        <div class="voteInputSection d-none" id="simpleDiv">
            <div class="form-group mb-4" id="titlediv">
                <label class="mb-2" for="title"><b><i class="fas fa-heading"></i> Title</b></label>
                <input type="text" class="form-control" id="title" placeholder="Title of the post" autocomplete="off">
            </div>
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group mb-4" id="documentDiv">
                        <label class="mb-2" for="simpledocumenthash"><i class="fas fa-folder"></i> Document</b></label>
                        <input type="text" class="form-control" id="simpledocumenthash" placeholder="Document hash"
                               autocomplete="off">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group mb-4">
                        <label class="mb-2"><b><i class="fas fa-star"></i> Reputation Stake</b></label>
                        <input type="text" class="form-control" id="simplestake" placeholder="Stake">
                    </div>
                </div>
            </div>

            <div class="form-group" id="descriptiondiv">
                <label class="mb-2" for="description"><b><i class="fas fa-list mx-1"></i> Description</b></label>
                <textarea type="text" id="description" name="description" placeholder="Description of the vote"
                          rows="10"></textarea>
            </div>
        </div>
        <div class="voteInputSection d-none" id="vaonboardingDiv">
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group mb-4">
                        <label class="mb-2"><b><i class="fas fa-id-badge"></i> New VA Username</b></label>
                        <input type="text" class="form-control" id="vausername" placeholder="Username">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group mb-4">
                        <label class="mb-2"><b><i class="fas fa-wallet"></i> New VA Public Key</b></label>
                        <input type="text" class="form-control" id="vaaddress" placeholder="User's public key">
                    </div>
                </div>
            </div>

            <div class="form-group mb-4">
                <label class="mb-2"><b><i class="fas fa-th-list"></i> Reason</b></label>
                <input type="text" class="form-control" id="reason" placeholder="Reason">
            </div>

            <p>*You must fill username OR public key</p>
        </div>
        <div class="voteInputSection d-none" id="repoDiv">
            <div class="row">
                <div class="form-group mb-4">
                    <label class="mb-2"><b><i class="fas fa-key"></i> Key</b></label>
                    <input type="text" class="form-control" id="repokey" placeholder="Key">
                </div>
                <div class="form-group mb-4">
                    <label class="mb-2"><b><i class="fas fa-star-of-life"></i> New Value</b></label>
                    <input type="text" class="form-control" id="repovalue" placeholder="Reason">
                </div>
                <div class="form-group mb-4">
                    <label class="mb-2"><b><i class="fas fa-star"></i> Reputation Stake</b></label>
                    <input type="text" class="form-control" id="repostake" placeholder="Stake">
                </div>
            </div>
        </div>
        <div class="voteInputSection d-none" id="kycDiv">
            <div class="form-group mb-4">
                <label class="mb-2"><b><i class="fas fa-user"></i> KYC Username</b></label>
                <input type="text" class="form-control" id="kycusername" placeholder="Username">
            </div>
            <div class="form-group mb-4">
                <label class="mb-2"><b><i class="fas fa-star"></i> Reputation Stake</b></label>
                <input type="text" class="form-control" id="kycstake" placeholder="Stake">
            </div>
            <span id="kycavailablity"> </span>
        </div>
        <div class="voteInputSection d-none" id="reputationDiv">
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group mb-4">
                        <label class="mb-2"><b><i class="fas fa-id-badge"></i> VA Username</b></label>
                        <input type="text" class="form-control" id="repusername" placeholder="Username">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group mb-4">
                        <label class="mb-2"><b><i class="fas fa-wallet"></i> VA Public Key</b></label>
                        <input type="text" class="form-control" id="repwallet" placeholder="User's public key">
                    </div>
                </div>
            </div>

            <div class="form-group mb-4">
                <label class="mb-2"><b><i class="fas fa-exclamation-circle"></i> Action</b></label>
                <select class="form-control" id="repaction" placeholder="Action">
                    <option val="1">Mint</option>
                    <option val="0">Burn</option>
                </select>
            </div>
            <div class="form-group mb-4">
                <label class="mb-2"><b><i class="fas fa-sort-numeric-up-alt"></i> Amount</b></label>
                <input type="text" class="form-control" id="repamount" placeholder="Amount">
            </div>
            <div class="form-group mb-4">
                <label class="mb-2"><b><i class="fas fa-folder"></i> Document</b></label>
                <input type="text" class="form-control" id="repdocumenthash" placeholder="Document">
            </div>
            <div class="form-group mb-4">
                <label class="mb-2"><b><i class="fas fa-star"></i> Stake</b></label>
                <input type="text" class="form-control" id="repstake" placeholder="Stake">
            </div>

            <p>*You must fill username OR public key</p>

        </div>
        <div class="voteInputSection d-none" id="slashingDiv">
            <div class="row">
                <div class="col-md-6">
                    <div class="form-group mb-4">
                        <label class="mb-2"><b><i class="fas fa-id-badge"></i> VA Username</b></label>
                        <input type="text" class="form-control" id="slashusername" placeholder="Username">
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group mb-4">
                        <label class="mb-2"><b><i class="fas fa-user"></i> Address To Slash</b></label>
                        <input type="text" class="form-control" id="slashaddress" placeholder="User's public key">
                    </div>
                </div>
            </div>

            <div class="form-group mb-4">
                <label class="mb-2"><b><i class="fas fa-percentage"></i> Slash Ratio</b></label>
                <input type="text" class="form-control" id="slashraito" placeholder="Slash ratio. (Eg. 0.05 for 5%)">
            </div>
            <div class="form-group mb-4">
                <label class="mb-2"><b><i class="fas fa-star"></i> Stake</b></label>
                <input type="text" class="form-control" id="slashstake" placeholder="Stake">
            </div>

            <p>*You must fill username OR public key</p>
        </div>

        <div class="d-flex justify-content-end my-3">
            <button type="submit" class="btn btn-danger text-white submitFormButton me-3" onclick="ShowVoteTypes();">Cancel</button>
            <button type="submit" class="btn btn-primary submitFormButton" onclick="StartNewVote();">Start Voting</button>
        </div>
    </div>
</div>

@section Scripts{

    <script>
        var votetype = "";

        $(document).ready(function () {
            if (document.body.classList.contains('dark-theme')) {
                CKEDITOR.replace('description', {
                    skin: 'moono-dark'
                });
            }
            else {
                CKEDITOR.replace('description', {
                    skin: 'moono-lisa'
                });
            }
        });

        function ShowVoteTypes() {
            $('.voteInputSection').removeClass("d-none");
            $('#typeSelectionDiv').removeClass("d-none");
            $('#voteInputsDiv').addClass("d-none");
        }

        function SelectVoteType(voteType) {
            $('.voteInputSection').addClass("d-none");
            $('#typeSelectionDiv').addClass("d-none");
            $('#voteInputsDiv').removeClass("d-none");
            $('#' + voteType + "Div").removeClass("d-none");
            votetype = voteType;
        }

        //Add new simple vote function
        async function StartNewVote() {

            if (votetype == "simple") {
                startOnchainSimpleVote();
            }
            else if (votetype == "vaonboarding") {
                startOnchainVaOnboardingVote();
            }
            else if (votetype == "repo") {
                startOnchainRepoVote();
            }
            else if (votetype == "kyc") {
                startOnchainKycVote();
            }
            else if (votetype == "reputation") {
                startOnchainReputationVote();
            }
            else if (votetype == "slashing") {
                startOnchainSlashingVote();
            }
        }

        async function CreateAndSendDeploy(requestUrl, sendDeployFunction) {
            const isConnected = await window.casperlabsHelper.isConnected();
            if (isConnected) {
                ShowLoader("Creating deploy object...");
                //Ajax post action
                $.ajax({
                    type: "GET",
                    url: requestUrl,
                    success: async function (result) {
                        if (result.success) {
                            ShowLoader("Waiting for sign...");
                            //const publicKeyHex = await window.casperlabsHelper.getActivePublicKey();
                            var deployJson = { "deploy": JSON.parse(result.message) };

                            // Sign transcation using casper-signer.
                            const signature = await window.casperlabsHelper.sign(deployJson);

                            ShowLoader("Sending signed deploy. This may take few minutes...");

                            $.confirm({
                                title: 'Confirmation',
                                content: '<p>Are you sure you want to start vote process ?</p>',
                                columnClass: 'col-md-8 col-md-offset-2',
                                buttons: {
                                    cancel: {
                                        text: 'Cancel'
                                    },
                                    confirm: {
                                        text: 'Continue',
                                        btnClass: 'btn btn-primary',
                                        action: function () {
                                            sendDeployFunction(signature.deploy)
                                        }

                                    }
                                }
                            });
                            //SendSignedDeploy(signature.deploy, "KYC Contract Call");
                        }
                        else {
                            HideLoader();
                            toastr.warning(result.message);
                        }
                    },
                    failure: function (response) {
                        HideLoader();
                        toastr.warning("@Lang.ConnectionError");
                    },
                    error: function (response) {
                        HideLoader();
                        toastr.error("@Lang.UnexpectedError");
                    }
                });
            }
            else {
                toastr.warning("Please connect the Casper Signer browser extension.");
            }
        }

        function startSimpleVote(signedDeployJson) {

            //Simple Vote parameters
            var documentHash = $("#simpledocumenthash").val();
            var title = $("#title").val();
            var description = CKEDITOR.instances["description"].getData();
            var stake = $("#simplestake").val();

            //Ajax post action
            $.ajax({
                type: "POST",
                url: "../Home/New_Vote_Simple",
                data: {
                    "stake": stake,
                    "documentHash": documentHash,
                    "title": title,
                    "description": description,
                    "signedDeployJson": JSON.stringify(signedDeployJson)
                },
                success: function (result) {
                    if (result.success) {
                        window.location.reload();
                    }
                    else {
                        toastr.warning(result.message);
                    }
                },
                failure: function (response) {
                    toastr.warning("@Lang.ConnectionError");
                },
                error: function (response) {
                    toastr.error("@Lang.UnexpectedError");
                }
            });

        }

        function startVaOnboardingVote(signedDeployJson) {
            //VA Onboarding Vote parameters
            var newvausername = $("#vausername").val();
            var vaaddress = $("#vaaddress").val();
            var reason = $("#reason").val();
            var stake = $("#vaonboardingstake").val();

            //Ajax post action
            $.ajax({
                type: "POST",
                url: "../Home/New_Vote_VaOnboarding",
                data: {
                    "stake": stake,
                    "reason": reason,
                    "newvausername": newvausername,
                    "newvaaddress": vaaddress,
                    "signedDeployJson": JSON.stringify(signedDeployJson)
                },
                success: function (result) {
                    if (result.success) {
                        window.location.reload();
                    }
                    else {
                        toastr.warning(result.message);
                    }
                },
                failure: function (response) {
                    toastr.warning("@Lang.ConnectionError");
                },
                error: function (response) {
                    toastr.error("@Lang.UnexpectedError");
                }
            });
        }

        function startRepoVote(signedDeployJson) {
            //VA Repo Vote parameters
            var key = $("#repokey").val();
            var value = $("#repovalue").val();
            var stake = $("#repostake").val();

            //Ajax post action
            $.ajax({
                type: "POST",
                url: "../Home/New_Vote_Governance",
                data: {
                    "stake": stake,
                    "key": key,
                    "value": value,
                    "signedDeployJson": JSON.stringify(signedDeployJson)
                },
                success: function (result) {
                    if (result.success) {
                        window.location.reload();
                    }
                    else {
                        toastr.warning(result.message);
                    }
                },
                failure: function (response) {
                    toastr.warning("@Lang.ConnectionError");
                },
                error: function (response) {
                    toastr.error("@Lang.UnexpectedError");
                }
            });
        }

        function startKycVote(signedDeployJson) {

            //KYC Vote parameters
            var kycUserName = $("#kycusername").val();
            var stake = $("#kycstake").val();

            //Ajax post action
            $.ajax({
                type: "POST",
                url: "../Home/New_Vote_KYC",
                data: {
                    "stake": stake,
                    "kycUserName": kycUserName,
                    "signedDeployJson": JSON.stringify(signedDeployJson)
                },
                success: function (result) {
                    if (result.success) {
                        window.location.reload();
                    }
                    else {
                        toastr.warning(result.message);
                    }
                },
                failure: function (response) {
                    toastr.warning("@Lang.ConnectionError");
                },
                error: function (response) {
                    toastr.error("@Lang.UnexpectedError");
                }
            });

        }

        function startReputationVote(signedDeployJson) {

            //Reputation Vote parameters
            var action = parseInt($("#repaction").val());
            var subjectaddress = $("#repwallet").val();
            var amount = $("#repamount").val();
            var documenthash = $("#repdocumenthash").val();
            var stake = $("#repstake").val();
            var repusername = $("#repusername").val();

            //Ajax post action
            $.ajax({
                type: "POST",
                url: "../Home/New_Vote_Reputation",
                data: {
                    "action": action,
                    "subjectaddress": subjectaddress,
                    "amount": amount,
                    "documenthash": documenthash,
                    "stake": stake,
                    "repusername": repusername,
                    "signedDeployJson": JSON.stringify(signedDeployJson)
                },
                success: function (result) {
                    if (result.success) {
                        window.location.reload();
                    }
                    else {
                        toastr.warning(result.message);
                    }
                },
                failure: function (response) {
                    toastr.warning("@Lang.ConnectionError");
                },
                error: function (response) {
                    toastr.error("@Lang.UnexpectedError");
                }
            });

        }

        function startSlashingVote(signedDeployJson) {

            //Reputation Vote parameters
            var address_to_slash = $("#slashaddress").val();
            var slash_ratio = $("#slashratio").val() * 1000;
            var stake = $("#slashstake").val();
            var slashusername = $("#slashusername").val();

            //Ajax post action
            $.ajax({
                type: "POST",
                url: "../Home/New_Vote_Slashing",
                data: {
                    "addresstoslash": address_to_slash,
                    "slashratio": slash_ratio,
                    "stake": stake,
                    "slashusername": slashusername,
                    "signedDeployJson": JSON.stringify(signedDeployJson)
                },
                success: function (result) {
                    if (result.success) {
                        window.location.reload();
                    }
                    else {
                        toastr.warning(result.message);
                    }
                },
                failure: function (response) {
                    toastr.warning("@Lang.ConnectionError");
                },
                error: function (response) {
                    toastr.error("@Lang.UnexpectedError");
                }
            });

        }

    </script>

    @if (Program._settings.DaoBlockchain == Helpers.Constants.Enums.Blockchain.Casper)
    {
        <script>

            async function startOnchainSimpleVote() {
                CreateAndSendDeploy("../CasperChain/GetSimpleVoteDeploy?documenthash=" + $("#documenthash").val() + "&stake=" + $("#simplestake").val(), startSimpleVote);
            }

            async function startOnchainVaOnboardingVote() {
                CreateAndSendDeploy("../CasperChain/GetVaOnboardingVoteDeploy?username=" + $("#vausername").val() + "&newvaaddress=" + $("#vaaddress").val() + "&reason=" + $("#reason").val(), startVaOnboardingVote);
            }

            async function startOnchainRepoVote() {
                CreateAndSendDeploy("../CasperChain/GetRepoVoteDeploy?key=" + $("#repokey").val() + "&value=" + $("#repovalue").val() + "&stake=" + $("#repostake").val(), startRepoVote);
            }

            async function startOnchainKycVote() {
                CreateAndSendDeploy("../CasperChain/GetKYCVoteDeploy?username=" + $("#kycusername").val() + "&stake=" + $("#kycstake").val(), startKycVote);
            }

            async function startOnchainReputationVote() {
                CreateAndSendDeploy("../CasperChain/GetReputationVoteDeploy?action=" + $("#repaction").val() + "&stake=" + $("#repstake").val() + "&subjectaddress=" + $("#repwallet").val() + "&amount=" + $("#repamount").val() + "&documenthash=" + $("#repdocumenthash").val() + "&repusername=" + $("#repusername").val(), startReputationVote);
            }

            async function startOnchainSlashingVote() {
                CreateAndSendDeploy("../CasperChain/GetSlashingVoteDeploy?addresstoslash=" + $("#slashaddress").val() + "&slashratio=" + $("#slashratio").val() + "&stake=" + $("#slashstake").val() + "&slashusername=" + $("#slashusername").val(), startSlashingVote);
            }
        </script>
    }
    else if (Program._settings.DaoBlockchain == null)
    {
        @* Start votes without any onchain process *@
        <script>
            function startOnchainSimpleVote() {
                $.confirm({
                    title: 'Confirmation',
                    content: '<p>Are you sure you want to start vote process ?</p>',
                    columnClass: 'col-md-8 col-md-offset-2',
                    buttons: {
                        cancel: {
                            text: 'Cancel'
                        },
                        confirm: {
                            text: 'Continue',
                            btnClass: 'btn btn-primary',
                            action: function () {
                                startSimpleVote("")
                            }

                        }
                    }
                });
            }

            function startOnchainVaOnboardingVote() {
                $.confirm({
                    title: 'Confirmation',
                    content: '<p>Are you sure you want to start vote process ?</p>',
                    columnClass: 'col-md-8 col-md-offset-2',
                    buttons: {
                        cancel: {
                            text: 'Cancel'
                        },
                        confirm: {
                            text: 'Continue',
                            btnClass: 'btn btn-primary',
                            action: function () {
                                startVaOnboardingVote("")
                            }

                        }
                    }
                });
            }

            function startOnchainRepoVote() {
                $.confirm({
                    title: 'Confirmation',
                    content: '<p>Are you sure you want to start vote process ?</p>',
                    columnClass: 'col-md-8 col-md-offset-2',
                    buttons: {
                        cancel: {
                            text: 'Cancel'
                        },
                        confirm: {
                            text: 'Continue',
                            btnClass: 'btn btn-primary',
                            action: function () {
                                startRepoVote("")
                            }

                        }
                    }
                });
            }

            function startOnchainKycVote() {
                $.confirm({
                    title: 'Confirmation',
                    content: '<p>Are you sure you want to start vote process ?</p>',
                    columnClass: 'col-md-8 col-md-offset-2',
                    buttons: {
                        cancel: {
                            text: 'Cancel'
                        },
                        confirm: {
                            text: 'Continue',
                            btnClass: 'btn btn-primary',
                            action: function () {
                                startKycVote("")
                            }

                        }
                    }
                });
            }

            function startOnchainReputationVote() {
                $.confirm({
                    title: 'Confirmation',
                    content: '<p>Are you sure you want to start vote process ?</p>',
                    columnClass: 'col-md-8 col-md-offset-2',
                    buttons: {
                        cancel: {
                            text: 'Cancel'
                        },
                        confirm: {
                            text: 'Continue',
                            btnClass: 'btn btn-primary',
                            action: function () {
                                startReputationVote("")
                            }

                        }
                    }
                });
            }

            function startOnchainSlashingVote() {
                $.confirm({
                    title: 'Confirmation',
                    content: '<p>Are you sure you want to start vote process ?</p>',
                    columnClass: 'col-md-8 col-md-offset-2',
                    buttons: {
                        cancel: {
                            text: 'Cancel'
                        },
                        confirm: {
                            text: 'Continue',
                            btnClass: 'btn btn-primary',
                            action: function () {
                                startSlashingVote("")
                            }

                        }
                    }
                });
            }
        </script>
    }

}


    @*
    //OLD SCRIPT
    //Create job model
    var title = $('#title').val();
    var description = CKEDITOR.instances["description"].getData();
    var voteType = $('#voteType').val();
    var vausername = $('#vausername').val();

    //Create settings model
    var DefaultPolicingRate = parseFloat($('#DefaultPolicingRate').val());
    var MaxPolicingRate = parseFloat($('#MaxPolicingRate').val());
    var MinPolicingRate = parseFloat($('#MinPolicingRate').val());
    var ForumKYCRequired = false;
    if (parseInt($('#ForumKYCRequired').val()) == 1) { ForumKYCRequired = true; }
    var QuorumRatio = parseFloat($('#QuorumRatio').val());
    var InternalAuctionTime = parseInt($('#InternalAuctionTime').val());
    var PublicAuctionTime = parseInt($('#PublicAuctionTime').val());
    var AuctionTimeType = $('#AuctionTimeType').val();
    var VotingTime = parseInt($('#VotingTime').val());
    var VotingTimeType = $('#VotingTimeType').val();
    var ReputationConversionRate = parseFloat($('#ReputationConversionRate').val());
    var VAOnboardingSimpleVote = false;
    if (parseInt($('#VAOnboardingSimpleVote').val()) == 1) { VAOnboardingSimpleVote = true; }
    var SimpleVotingTime = parseInt($('#SimpleVotingTime').val());
    var SimpleVotingTimeType = $('#SimpleVotingTimeType').val();
    var DistributePaymentWithoutVote = false;
    if (parseInt($('#DistributePaymentWithoutVote').val()) == 1) { DistributePaymentWithoutVote = true; }
    var GovernancePaymentRatio = parseFloat($('#GovernancePaymentRatio').val());
    var GovernanceWallet = $('#GovernanceWallet').val();

    //KYC Vote parameters
    var documentHash = $("#kycdocumenthash").val();
    var kycUserName = $("#kycusername").val();

    //Ajax post action
    $.ajax({
    type: "POST",
    url: "../Home/New_SimpleVote_Post",
    data: {
    "title": title,
    "description": description,
    "type": voteType,
    "vausername": vausername,
    "documentHash": documentHash,
    "kycUserName": kycUserName,
    "settings": {
    "DefaultPolicingRate": DefaultPolicingRate,
    "MaxPolicingRate": MaxPolicingRate,
    "MinPolicingRate": MinPolicingRate,
    "ForumKYCRequired": ForumKYCRequired,
    "QuorumRatio": QuorumRatio,
    "InternalAuctionTime": InternalAuctionTime,
    "PublicAuctionTime": PublicAuctionTime,
    "AuctionTimeType": AuctionTimeType,
    "VotingTime": VotingTime,
    "VotingTimeType": VotingTimeType,
    "ReputationConversionRate": ReputationConversionRate,
    "SimpleVotingTime": SimpleVotingTime,
    "SimpleVotingTimeType": SimpleVotingTimeType,
    "DistributePaymentWithoutVote": DistributePaymentWithoutVote,
    "GovernancePaymentRatio": GovernancePaymentRatio,
    "GovernanceWallet": GovernanceWallet
    }
    },
    success: function (result) {
    if (result.success) {
    window.location.href = "../Votings";
    }
    else {
    toastr.warning(result.message);
    }
    },
    failure: function (response) {
    toastr.warning("@Lang.ConnectionError");
    },
    error: function (response) {
    toastr.error("@Lang.UnexpectedError");
    }
    });
*@